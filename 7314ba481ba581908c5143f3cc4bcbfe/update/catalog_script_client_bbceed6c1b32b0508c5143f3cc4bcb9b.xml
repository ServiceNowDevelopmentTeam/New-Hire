<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="catalog_script_client">
    <catalog_script_client action="INSERT_OR_UPDATE">
        <active>false</active>
        <applies_catalog>false</applies_catalog>
        <applies_extended>false</applies_extended>
        <applies_req_item>true</applies_req_item>
        <applies_sc_task>false</applies_sc_task>
        <applies_target_record>false</applies_target_record>
        <applies_to>item</applies_to>
        <cat_item display_value="New Hire Request">09f71b261b46e8108c5143f3cc4bcbb5</cat_item>
        <cat_variable/>
        <condition/>
        <description/>
        <field/>
        <global>true</global>
        <isolate_script>false</isolate_script>
        <messages/>
        <name>Email Mandatory if AD Task Closed(RITM)</name>
        <order>1000</order>
        <published_ref/>
        <script><![CDATA[function onLoad() {
    ////////////////////////////////////////////////////////////////////////////////////
    //If AD task is open, then New Employee Email is not mandatory. - new_employee_email
    //Paired with New Hire New Email Required business rule
    ////////////////////////////////////////////////////////////////////////////////////

    //Get AD account tasks that aren't closed
    var taskGr = new GlideRecord('sc_task');
    taskGr.addQuery('request_item', g_form.getUniqueValue());
    taskGr.addQuery('state','!=', '111');
    taskGr.addQuery('state','!=', '3');
    taskGr.addQuery('short_description', 'STARTSWITH', 'Create New AD Account');
	taskGr.addQuery('cat_item','09f71b261b46e8108c5143f3cc4bcbb5');
    taskGr.query();

	var email_yn = g_form.getValue('user_requires_email');
    //If there are open AD Tasks, then set email not mandatory
    if (!taskGr.hasNext() && g_form.getValue('new_employee_email') == '' && email_yn == 'yes') {
		g_form.setMandatory('new_employee_email', true);
		//g_form.setValue('state','3');
		//Add error under field
		g_form.showErrorBox('new_employee_email','This field is communicated to non-IT teams for other new hire tasks.',true);
		//Set the cursor focus on the required field
		document.addEventListener("DOMContentLoaded", function(event) { 
			document.getElementById('ni.VE1cf2cb981beab4108c5143f3cc4bcba2').focus();
		});
    }
	else{
		g_form.setMandatory('new_employee_email', false);
		console.log('sets else');
	}
}]]></script>
        <sys_class_name>catalog_script_client</sys_class_name>
        <sys_created_by>Terry.Lillo</sys_created_by>
        <sys_created_on>2021-09-21 13:45:41</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_domain_path>/</sys_domain_path>
        <sys_id>bbceed6c1b32b0508c5143f3cc4bcb9b</sys_id>
        <sys_mod_count>1</sys_mod_count>
        <sys_name>Email Mandatory if AD Task Closed(RITM)</sys_name>
        <sys_overrides/>
        <sys_package display_value="Global" source="global">global</sys_package>
        <sys_policy/>
        <sys_scope display_value="New Hire">7314ba481ba581908c5143f3cc4bcbfe</sys_scope>
        <sys_update_name>catalog_script_client_bbceed6c1b32b0508c5143f3cc4bcb9b</sys_update_name>
        <sys_updated_by>Terry.Lillo</sys_updated_by>
        <sys_updated_on>2023-10-25 15:38:06</sys_updated_on>
        <table/>
        <type>onLoad</type>
        <ui_type>10</ui_type>
        <variable_set/>
        <view/>
    </catalog_script_client>
    <sys_claim action="INSERT_OR_UPDATE">
        <claim_owner_scope display_value="New Hire">7314ba481ba581908c5143f3cc4bcbfe</claim_owner_scope>
        <claim_timestamp>1816d58ff870000001</claim_timestamp>
        <metadata_update_name>catalog_script_client_bbceed6c1b32b0508c5143f3cc4bcb9b</metadata_update_name>
        <previous_claim_app_version>1.0.1</previous_claim_app_version>
        <previous_claim_name>New Hire</previous_claim_name>
        <previous_claim_scope>7314ba481ba581908c5143f3cc4bcbfe</previous_claim_scope>
        <sys_created_by>Terry.Lillo</sys_created_by>
        <sys_created_on>2022-06-16 16:29:18</sys_created_on>
        <sys_id>ed5edeb21b88d11062e50ed2cd4bcbb6</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>Terry.Lillo</sys_updated_by>
        <sys_updated_on>2022-09-29 18:57:28</sys_updated_on>
    </sys_claim>
</record_update>
